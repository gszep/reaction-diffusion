<!DOCTYPE html>
<html lang="en">
	<head> <%- include ("header.ejs") %> </head>

	<body>
		<h1 style="font-family:'Computer Modern Sans'">
			Pattern formation in growing bacetrial colonies</h1>
		<div style="font-family:'Computer Modern Serif'">
<p>
	We would like to understand the behaviour of the lactone system [1] adapted to
	exhibit bistable behaviour. The system can be reduced to coupled partial
	differential equations governing the concentrations of inhibitors
	$\color{DarkCyan}{L}$,$\color{gold}{T}$, activators
	$\color{gray}{R}$,$\color{gray}{S}$ and diffusables
	$\color{DarkBlue}{C_{6}}$,$\color{DarkBlue}{C_{12}}$. The inhibitors are
	imaged via a downstream chemical cascade that lead to cyan and yellow
	flourescent proteins.
</p>
<p>
	Activation and inhibition strengths are given by $J,J'$ and $H,H'$
	respectively. The baseline production level of inhibitors is given by primed and
	unprimed $\omega$ and the saturation level by $\Omega$. The degradation rates
	of all components are given by primed and unprimed $\mu,\nu$. The activators $\color{gray}{R}$,$\color{gray}{S}$ must be bound to
	$\color{DarkBlue}{C_{6}}$,$\color{DarkBlue}{C_{12}}$ in order to induce the
	production of inhibitors $\color{DarkCyan}{L}$,$\color{gold}{T}$ respectively. The
	amount of $\color{DarkBlue}{C_{6}}$,$\color{DarkBlue}{C_{12}}$ needed to reach
	inhibitor production at full capacity is given by Hill coefficients $n,n'$ and
	disacocciation constants $k,k'$.
	$$
	\begin{align}
		\frac{d\color{DarkCyan}{L}}{dt} =
		J\frac{
		\color{gray}{R}^2
		\left(
		\frac{\color{DarkBlue}{C_6}}{k+\color{DarkBlue}{C_6}}
		\right)^n
		+\omega}
		{\Omega\color{gray}{R}^2
		\left(
		\frac{\color{DarkBlue}{\color{DarkBlue}{C_6}}}{k+\color{DarkBlue}{\color{DarkBlue}{C_6}}}
		\right)^n
		+1 }-\mu\color{DarkCyan}{L}
		\quad\qquad
		\frac{d\color{gray}{R}}{dt} =
		H\frac{1}{1+\color{gold}{T}^4}-\nu\color{gray}{R}
		\\
		\frac{d\color{gold}{T}}{dt} =
		J^\prime\frac{\color{gray}{S}^{2}
		\left(
		\frac{\color{DarkBlue}{C_{12}}}{k^\prime+\color{DarkBlue}{C_{12}}}
		\right)^{n\prime}
		+\omega^\prime }
		{\Omega^\prime\color{gray}{S}^{2}
		\left(
		\frac{\color{DarkBlue}{C_{12}}}{k^\prime+\color{DarkBlue}{C_{12}}}
		\right)^{n\prime}
		+1 }-\mu^\prime\color{gold}{T}
		\quad\quad
		\frac{d\color{gray}{S}}{dt} =
		H^\prime\frac{1}{1+\color{DarkCyan}{L}}-\nu^\prime \color{gray}{S}
		\\
		\frac{d\color{DarkBlue}{C_{6}}}{dt} = D_{6}\frac{d^2\color{DarkBlue}{C_{6}}}{dx^2}
		\qquad\qquad\quad\quad\quad\quad\quad\quad
		\frac{d\color{DarkBlue}{C_{12}}}{dt} = D_{12}\frac{d^2\color{DarkBlue}{C_{12}}}{dx^2}
		\quad\quad
	\end{align}
	$$
	There exists only one stable fixed point in this system. Setting all
	the right-hand-sides of the equations to zero, it becomes possible to
	invert expressions for $L(R,C_6)$, $T(S,C_{12})$ and $S(L)$
	then substituting these into equation for $\frac{dR}{dt}$ to obatin a
	closed equation $f(R,C_6,C_{12})$ containing all parameters.
	$$
		f(R,C_6,C_{12}) =
		\frac{H}{1+T(S(L(R,C_6)),C_{12})^4}-\nu R
	$$
	We are interested in the number of times this expression crosses zero.
	Since the denominator in the fraction is always positive, we can
	scale the expression and focus on
	$$
	f(R,C_6,C_{12}) =
	H-\nu R-R T(S(L(R,C_6)),C_{12})^4
	$$
	We have a positive intecept at $H$ and a leading negative linear term that
	will bring the function to cross zero. Since $T(S(L(R,C_6)),C_{12})^4$ is
	always positive the slope of the function will always be negative.
	Once the function crosses zero it will never return, leaving the system with
	only one stable fixed point, making it impossible to exhibit bistability.
	This suggests that $C_6$ and $C_{12}$ only serve to shift the location of
	the single stable fixed point.
				<br><br>
			</p>
		</div>
		<div id="simulation">

			<aside class="panel">

				<section id="instructions">
					<header><h4>Model</h4></header>
						Reduced Lactone System
						<br></br>
				</section>

				<section id="controls">
					<header><h4>Parameters</h4></header>

					Diffusion Ratio $D\,'/D$:
					<span class="remark" id="diffusionRatio"></span><br/>
					<div id="diffusionRatioSlider" class="slider"></div>

					L Activation $\beta$:
					<span class="remark" id="beta"></span><br/>
					<div id="betaSlider" class="slider"></div>
					T Activation $\beta'$:
					<span class="remark" id="betadash"></span><br/>
					<div id="betadashSlider" class="slider"></div>

					Baseline Inhibition $\omega$:
					<span class="remark" id="omega"></span><br/>
					<div id="omegaSlider" class="slider"></div>
					Baseline Inhibition $\omega'$:
					<span class="remark" id="omegadash"></span><br/>
					<div id="omegadashSlider" class="slider"></div>

					Inhibitor Saturation $\Omega$:
					<span class="remark" id="Omega"></span><br/>
					<div id="OmegaSlider" class="slider"></div>
					Inhibitor Saturation $\Omega'$:
					<span class="remark" id="Omegadash"></span><br/>
					<div id="OmegadashSlider" class="slider"></div>

					<!-- Noise:
					<span class="remark" id="noise"></span><br/>
					<div id="noiseSlider" class="slider"></div> -->

					Grid Size:
					<span class="remark" id="gridSize"></span><br/>
					<div id="gridSizeSlider" class="slider"></div>

					Time Step:
					<span class="remark" id="timeStep"></span><br/>
					<div id="timeStepSlider" class="slider"></div>

					Colors:
					<div id="gradient"></div>
				</section>

			</aside>

			<canvas id="simulation-canvas" width="1024px" height="512px"
				style="width:1024px;height:512px;border:1px solid black"></canvas>

			<script>

				// initialise color scheme
				$("#gradient").gradient({values: [[0.0,'#000000'],
				[0.31,'#000080'],[0.32,'#808080'],
				[0.33,'#000080'],[0.34,'#808080'],
				[0.7,'#008b8b'],[0.8,'#FFDF00']
			]})

				// instantiate simulation canvas
				Solver = new Simulation('simulation-canvas')

			</script>
		</div>
		<br><br>
		<p>
			[1] Grant, P. et al. 2016. Orthogonal intercellular signaling for programmed spatial behavior <br>
			[2] Smith-Roberge, J. et al. 2018. Pattern formation in bacterial colonies with density-dependent diffusion
		</p>
	</body>
</html>
